<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>矿点星球</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;user-select:none}
html,body{height:100%;background:#1a1a1a;color:#ffcc00;font-family:system-ui}
.top{position:fixed;top:0;left:0;width:100%;height:70px;background:#2b2b2b;display:flex;align-items:center;justify-content:space-between;padding:0 16px;border-bottom:2px solid #ffcc00}
.top .info{display:flex;gap:16px}
.btn{background:#ffcc00;color:#000;border-radius:6px;padding:10px 12px;border:0;font-weight:bold}
.container{margin-top:80px;padding:16px;max-width:480px;margin-left:auto;margin-right:auto}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px}
.card{background:#2b2b2b;border-radius:8px;padding:12px;border:1px solid #444;text-align:center}
.card h3{margin-bottom:8px}
.nav{position:fixed;bottom:0;left:0;width:100%;height:60px;background:#2b2b2b;display:grid;grid-template-columns:repeat(4,1fr);border-top:2px solid #ffcc00}
.nav button{background:transparent;color:#ffcc00;border:0;font-weight:bold}
.nav .active{background:#ffcc00;color:#000;border-radius:6px;margin:4px}
.page{display:none}
.page.active{display:block}
</style>
</head>
<body>

<div class="top">
  <div class="info">
    <div>金币:<span id="gold">0</span></div>
    <div>算力:<span id="power">0</span></div>
  </div>
  <button class="btn" id="sign">签到</button>
</div>

<div class="container">
  <div class="page active" id="page1">
    <h3>矿工</h3>
    <div class="grid">
      <div class="card"><h3>新手矿工</h3><button class="btn" id="h1">免费领取</button></div>
      <div class="card"><h3>熟练矿工</h3><button class="btn" id="h2">500 金币</button></div>
      <div class="card"><h3>精英矿工</h3><button class="btn" id="h3">1200 金币</button></div>
      <div class="card"><h3>专家矿工</h3><button class="btn" id="h4">2500 金币</button></div>
      <div class="card"><h3>大师矿工</h3><button class="btn" id="h5">5000 金币</button></div>
      <div class="card"><h3>传说矿工</h3><button class="btn" id="h6">10000 金币</button></div>
    </div>
  </div>

  <div class="page" id="page2">
    <h3>道具</h3>
    <div class="grid">
      <div class="card"><h3>加速</h3><button class="btn" id="b1">500</button></div>
      <div class="card"><h3>幸运</h3><button class="btn" id="b2">1000</button></div>
      <div class="card"><h3>超级</h3><button class="btn" id="b3">2000</button></div>
      <div class="card"><h3>千问Key</h3><button class="btn" id="exchange">10000</button></div>
    </div>
  </div>
</div>

<div class="nav">
  <button onclick="goto(1)" class="active">矿工</button>
  <button onclick="goto(2)">道具</button>
</div>

<script>
let uid = localStorage.getItem("uid");
if(!uid){ uid = "u"+Date.now(); localStorage.setItem("uid",uid); }

async function api(action,data={}){
  let r = await fetch("/api.php",{method:"POST",body:JSON.stringify({uid,action,...data})});
  return await r.json();
}

function render(d){
  document.getElementById("gold").innerText = d.gold||0;
  document.getElementById("power").innerText = d.power||0;
}

async function load(){ render(await api("load")); }
load(); setInterval(load,1000);

document.getElementById("sign").onclick = async ()=>{
  let d = await api("sign"); alert(d.msg); render(d);
};

document.getElementById("h1").onclick = async ()=>{
  let d = await api("hire",{id:1}); alert(d.msg); render(d);
};
document.getElementById("h2").onclick = async ()=>{
  let d = await api("hire",{id:2}); alert(d.msg); render(d);
};
document.getElementById("h3").onclick = async ()=>{
  let d = await api("hire",{id:3}); alert(d.msg); render(d);
};
document.getElementById("h4").onclick = async ()=>{
  let d = await api("hire",{id:4}); alert(d.msg); render(d);
};
document.getElementById("h5").onclick = async ()=>{
  let d = await api("hire",{id:5}); alert(d.msg); render(d);
};
document.getElementById("h6").onclick = async ()=>{
  let d = await api("hire",{id:6}); alert(d.msg); render(d);
};

document.getElementById("b1").onclick = async ()=>{
  let d = await api("buff",{t:1}); alert(d.msg); render(d);
};
document.getElementById("b2").onclick = async ()=>{
  let d = await api("buff",{t:2}); alert(d.msg); render(d);
};
document.getElementById("b3").onclick = async ()=>{
  let d = await api("buff",{t:3}); alert(d.msg); render(d);
};

document.getElementById("exchange").onclick = async ()=>{
  let d = await api("exchange"); alert(d.msg); render(d);
};

function goto(i){
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  document.getElementById("page"+i).classList.add("active");
  document.querySelectorAll(".nav button").forEach(b=>b.classList.remove("active"));
  document.querySelectorAll(".nav button")[i-1].classList.add("active");
}
</script>
</body>
</html>